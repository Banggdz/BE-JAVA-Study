-- Tạo database
DROP DATABASE IF EXISTS estatebasic;
CREATE DATABASE estatebasic CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
USE estatebasic;

-- Bảng district
CREATE TABLE district (
  id BIGINT(20) NOT NULL AUTO_INCREMENT,
  code VARCHAR(255) NOT NULL,
  name VARCHAR(255) NOT NULL,
  PRIMARY KEY (id),
  UNIQUE KEY (code)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

INSERT INTO district (id, code, name) VALUES
(1,'Q1','Quận 1'),
(2,'Q2','Quận 2'),
(3,'Q4','Quận 4');

-- Bảng user
CREATE TABLE user (
  id BIGINT(20) NOT NULL AUTO_INCREMENT,
  username VARCHAR(255) NOT NULL,
  password VARCHAR(255) NOT NULL,
  fullname VARCHAR(255),
  phone VARCHAR(255),
  email VARCHAR(255),
  status INT(11) NOT NULL,
  createddate DATETIME,
  modifieddate DATETIME,
  createdby VARCHAR(255),
  modifiedby VARCHAR(255),
  PRIMARY KEY (id),
  UNIQUE KEY (username)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

INSERT INTO user (id, username, password, fullname, status) VALUES
(1,'nguyenvana','123456','nguyen van a',1),
(2,'nguyenvanb','123456','nguyen van b',1),
(3,'nguyenvanc','123456','nguyen van c',1),
(4,'nguyenvand','123456','nguyen van d',1);

-- Bảng role
CREATE TABLE role (
  id BIGINT(20) NOT NULL AUTO_INCREMENT,
  name VARCHAR(255) NOT NULL,
  code VARCHAR(255) NOT NULL,
  createddate DATETIME,
  modifieddate DATETIME,
  createdby VARCHAR(255),
  modifiedby VARCHAR(255),
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

INSERT INTO role (id,name,code) VALUES
(1,'Quản lý','manager'),
(2,'Nhân viên','staff');

-- Bảng user_role
CREATE TABLE user_role (
  id BIGINT(20) NOT NULL AUTO_INCREMENT,
  roleid BIGINT(20) NOT NULL,
  userid BIGINT(20) NOT NULL,
  createddate DATETIME,
  modifieddate DATETIME,
  createdby VARCHAR(255),
  modifiedby VARCHAR(255),
  PRIMARY KEY (id),
  FOREIGN KEY (roleid) REFERENCES role(id),
  FOREIGN KEY (userid) REFERENCES user(id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

INSERT INTO user_role (id, roleid, userid) VALUES
(1,1,1),(2,2,2),(3,2,3),(4,2,4);

-- Bảng building
CREATE TABLE building (
  id BIGINT(20) NOT NULL AUTO_INCREMENT,
  name VARCHAR(255) NOT NULL,
  street VARCHAR(255),
  ward VARCHAR(255),
  districtid BIGINT(20) NOT NULL,
  structure VARCHAR(255),
  numberofbasement INT(11),
  floorarea INT(11),
  direction VARCHAR(255),
  level VARCHAR(255),
  rentprice INT(11) NOT NULL,
  rentpricedescription TEXT,
  servicefee VARCHAR(255),
  carfee VARCHAR(255),
  motorbikefee VARCHAR(255),
  overtimefee VARCHAR(255),
  waterfee VARCHAR(255),
  electricityfee VARCHAR(255),
  deposit VARCHAR(255),
  payment VARCHAR(255),
  renttime VARCHAR(255),
  decorationtime VARCHAR(255),
  brokeragefee DECIMAL(13,2),
  note VARCHAR(255),
  linkofbuilding VARCHAR(255),
  map VARCHAR(255),
  image VARCHAR(255),
  createddate DATETIME,
  modifieddate DATETIME,
  createdby VARCHAR(255),
  modifiedby VARCHAR(255),
  managername VARCHAR(255),
  managerphonenumber VARCHAR(255),
  PRIMARY KEY (id),
  FOREIGN KEY (districtid) REFERENCES district(id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

INSERT INTO building (id,name,street,ward,districtid,numberofbasement,floorarea,rentprice,rentpricedescription,managername,managerphonenumber) VALUES
(1,'Nam Giao Building Tower','59 phan xích long','Phường 2',1,2,500,15,'15 triệu/m2','Anh Nam-Chị Linh','0915354727'),
(2,'ACM Tower','96 cao thắng','Phường 4',2,2,650,18,'18 triệu/m2','Chú Thuận','0173546263'),
(3,'Alpha 2 Building Tower','153 nguyễn đình chiểu','Phường 6',1,1,200,20,'20 triệu/m2','Cô Lý','0555532578'),
(4,'IDD 1 Building','111 Lý Chính Thắng','Phường 7',3,1,200,12,'12 triệu/m2','Anh Long','017345253');

-- Bảng assignmentbuilding
CREATE TABLE assignmentbuilding (
  id BIGINT(20) NOT NULL AUTO_INCREMENT,
  staffid BIGINT(20) NOT NULL,
  buildingid BIGINT(20) NOT NULL,
  createddate DATETIME,
  modifieddate DATETIME,
  createdby VARCHAR(255),
  modifiedby VARCHAR(255),
  PRIMARY KEY (id),
  FOREIGN KEY (staffid) REFERENCES user(id),
  FOREIGN KEY (buildingid) REFERENCES building(id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

INSERT INTO assignmentbuilding (id,staffid,buildingid) VALUES
(1,2,1),(2,2,3),(3,3,1),(4,3,4);

-- Bảng renttype
CREATE TABLE renttype (
  id BIGINT(20) NOT NULL AUTO_INCREMENT,
  code VARCHAR(255) NOT NULL,
  name VARCHAR(255) NOT NULL,
  PRIMARY KEY (id),
  UNIQUE KEY (code)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

INSERT INTO renttype (id,code,name) VALUES
(1,'tang-tret','Tầng trệt'),
(2,'nguyen-can','Nguyên căn'),
(3,'noi-that','Nội thất');

-- Bảng buildingrenttype
CREATE TABLE buildingrenttype (
  id BIGINT(20) NOT NULL AUTO_INCREMENT,
  buildingid BIGINT(20) NOT NULL,
  renttypeid BIGINT(20) NOT NULL,
  PRIMARY KEY (id),
  FOREIGN KEY (buildingid) REFERENCES building(id),
  FOREIGN KEY (renttypeid) REFERENCES renttype(id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

INSERT INTO buildingrenttype (id,buildingid,renttypeid) VALUES
(1,1,1),(2,1,2),(3,2,2),(4,3,3),(5,4,1),(6,4,2),(7,4,3);

-- Bảng customer
CREATE TABLE customer (
  id BIGINT(20) NOT NULL AUTO_INCREMENT,
  fullname VARCHAR(255),
  phone VARCHAR(255),
  email VARCHAR(255),
  createddate DATETIME,
  modifieddate DATETIME,
  createdby VARCHAR(255),
  modifiedby VARCHAR(255),
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- Bảng assignmentcustomer
CREATE TABLE assignmentcustomer (
  id BIGINT(20) NOT NULL AUTO_INCREMENT,
  staffid BIGINT(20) NOT NULL,
  customerid BIGINT(20) NOT NULL,
  createddate DATETIME,
  modifieddate DATETIME,
  createdby VARCHAR(255),
  modifiedby VARCHAR(255),
  PRIMARY KEY (id),
  FOREIGN KEY (staffid) REFERENCES user(id),
  FOREIGN KEY (customerid) REFERENCES customer(id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- Bảng rentarea
CREATE TABLE rentarea (
  id BIGINT(20) NOT NULL AUTO_INCREMENT,
  value INT(11),
  buildingid BIGINT(20) NOT NULL,
  createddate DATETIME,
  modifieddate DATETIME,
  createdby VARCHAR(255),
  modifiedby VARCHAR(255),
  PRIMARY KEY (id),
  FOREIGN KEY (buildingid) REFERENCES building(id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

INSERT INTO rentarea (id,value,buildingid) VALUES
(1,100,1),(2,200,1),(3,200,2),(4,300,2),(5,400,2),(6,300,3),(7,400,3),(8,500,3),(9,100,4),(10,400,4),(11,250,4);

-- Bảng transactiontype
CREATE TABLE transactiontype (
  id BIGINT(20) NOT NULL AUTO_INCREMENT,
  name VARCHAR(255) NOT NULL,
  code VARCHAR(255) NOT NULL,
  createddate TIMESTAMP NULL DEFAULT NULL,
  modifieddate TIMESTAMP NULL DEFAULT NULL,
  createdby VARCHAR(255),
  modifiedby VARCHAR(255),
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- Bảng transaction
CREATE TABLE transaction (
  id BIGINT(20) NOT NULL AUTO_INCREMENT,
  note VARCHAR(255),
  customerid BIGINT(20) NOT NULL,
  createddate DATETIME,
  modifieddate DATETIME,
  createdby VARCHAR(255),
  modifiedby VARCHAR(255),
  type BIGINT(20),
  PRIMARY KEY (id),
  FOREIGN KEY (customerid) REFERENCES customer(id),
  FOREIGN KEY (type) REFERENCES transactiontype(id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;
